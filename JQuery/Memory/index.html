<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <style>
        body {
            font-family: Arial;
            text-align: center;
        }
        #tablero {
            margin: 20px auto;
            border-collapse: collapse;
        }
        .ficha img{
            width: 100px;
            height: 100px;
            border: 1px solid #000;
            background-color: #ccc;
            cursor: pointer;
            background-size: cover;
            background-position: center;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
        }
        .permanente{
            filter: brightness(.5);
        }
    </style>
</head>
<body>
    <button id="btn-iniciar">Iniciar</button>
    <button id="btn-reordenar">Reordenar cartas</button>

    <table id="tablero">
        <tr>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
        </tr>
        <tr>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
        </tr>
        <tr>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
        </tr>
        <tr>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
            <td class="ficha"></td>
        </tr>
    </table>
    
    <script>


        var imagenes = [
                        '1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '7.jpg', '8.jpg', '9.jpg', '10.jpg',
                        '1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '7.jpg', '8.jpg', '9.jpg', '10.jpg'
                    ]

        var cartas = []
        var primeraCarta = null
        var segundaCarta = null
        var bloqueado = false

        function mezclarCartas(array) {
            var copia = array.slice()
            var mezcladas = []
            while (copia.length) {
                var indiceAleatorio = Math.floor(Math.random() * copia.length)
                mezcladas.push(copia.splice(indiceAleatorio, 1)[0])
            }
            return mezcladas
        }

        function cargarCartasInicial() {
            // Mostrar las cartas vacías al inicio
            $(".ficha").each(function() {
                $(this).html("<img src=''>") // Imagen vacía
                $(this).removeClass("revelada permanente")
            });
        }

        function cargarCartas() {
            cartas = mezclarCartas(imagenes);

            // Asignar imágenes y mostrarlas
            $(".ficha").each(function(index) {
                $(this).attr("data-imagen", cartas[index]);// Usar un atributo personalizado
                $(this).html("<img src='" + cartas[index] + "'>") // Mostrar las imágenes
                $(this).removeClass("revelada permanente")
            });
        }

        function voltearCartas(carta) {
            if (bloqueado || $(carta).hasClass("permanente") || $(carta).hasClass("revelada")) return

            // Mostrar la imagen de la carta
            var imagen = $(carta).attr("data-imagen")
            $(carta).html("<img src='" + imagen + "'>").addClass("revelada")

            if (!primeraCarta) {
                primeraCarta = carta
            } else if (!segundaCarta) {
                segundaCarta = carta
                verificarPareja()
            }
        }

        function verificarPareja() {
            bloqueado = true
            var imagen1 = $(primeraCarta).attr("data-imagen")
            var imagen2 = $(segundaCarta).attr("data-imagen")

            if (imagen1 === imagen2) {
                // Las cartas coinciden: dejarlas reveladas permanentemente
                $(primeraCarta).addClass("permanente")
                $(segundaCarta).addClass("permanente")
                resetSeleccion()
            } else {
                // Las cartas no coinciden: voltearlas después de 1.5 segundos
                setTimeout(function() {
                    $(primeraCarta).html("<img src='atras.jpg'>").removeClass("revelada")
                    $(segundaCarta).html("<img src='atras.jpg'>").removeClass("revelada")
                    resetSeleccion()
                }, 1500)
            }
        }

        function resetSeleccion() {
            primeraCarta = null
            segundaCarta = null
            bloqueado = false

            // Comprobar si todas las cartas están descubiertas
            if ($(".ficha.permanente").length === $(".ficha").length) {
                alert("¡Ganaste!")
            }
        }

        $("#btn-iniciar").on("click", function() {
            // Voltear todas las cartas al reverso
            $(".ficha").each(function() {
                $(this).html("<img src='atras.jpg'>")
                $(this).removeClass("revelada")
            });
        });

        $("#btn-reordenar").on("click", function() {
            cargarCartas()
        });

        $("#tablero").on("click", ".ficha", function() {
            voltearCartas(this)
        });

        // Cargar el tablero vacío al inicio
        cargarCartasInicial()
        

    </script>

</body>
</html>